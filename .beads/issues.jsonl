{"id":"sb-4re","title":"AskUserQuestion tool triggers permission hook causing TTS conflicts","description":"## Problem\nWhen using the AskUserQuestion tool, the permission hook is triggered. This causes two issues:\n\n1. **Cool-off period blocking**: Sometimes the request is blocked by a cool-off period\n2. **TTS conflicts**: When the permission hook does go through, the TTS request plays concurrently with the interview TTS, creating audio overlap\n3. **No real question**: The permission hook fires but there's no meaningful question being processed\n\n## Scope\nAffects **all TTS-enabled skills** that use AskUserQuestion, not just interviews.\n\n## Root Cause\nAskUserQuestion triggers the permission hook which attempts its own TTS, conflicting with TTS already in progress from the calling skill.\n\n## Solution: Merge/Dedupe with Context Flag\n\n### Approach\nImplement deduplication in the **TTS plugin** using a context flag:\n\n1. When a skill initiates TTS playback, set a flag indicating active TTS session\n2. Permission hook checks this flag before attempting its own TTS\n3. If flag is set, skip the permission hook TTS (visual prompt still shows)\n4. Clear flag when TTS playback completes\n\n### Implementation Location\n- **TTS plugin** (claude-mlx-tts): Manages the active-voice flag\n- Flag could be a temp file, environment variable, or plugin state\n\n### Acceptance Criteria\n- [ ] AskUserQuestion permission prompts don't trigger TTS during active voice sessions\n- [ ] Visual permission prompts still display normally\n- [ ] TTS resumes normal behavior after skill completes\n- [ ] Works across all skills, not just interview","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-05T10:32:02.229944-08:00","created_by":"agrande","updated_at":"2026-01-05T10:46:32.172221-08:00"}
{"id":"sb-4y1","title":"claude-spec-builder: Adaptive Interview Plugin","description":"Claude Code plugin for structured requirements gathering via adaptive interviews. Integrates with Beads (epic/subtask generation) and Claude MLX TTS (voice interviews).","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-04T16:05:27.295377-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:40.96654-08:00","closed_at":"2026-01-04T16:23:40.96654-08:00","close_reason":"Closed"}
{"id":"sb-4y1.1","title":"M1: Core Interview Flow","description":"Skill files + command + basic 9-phase interview flow. Foundation for all other milestones.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:05:43.977083-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:41.346044-08:00","closed_at":"2026-01-04T16:17:41.346044-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1","depends_on_id":"sb-4y1","type":"parent-child","created_at":"2026-01-04T16:05:43.979407-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.10","title":"Integrate AskUserQuestion","description":"Use AskUserQuestion tool for structured 2-4 option choices during interview","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:06:58.534741-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.704797-08:00","closed_at":"2026-01-04T16:17:24.704797-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.10","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.535201-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.11","title":"Implement spec output with path detection","description":"Generate markdown spec, detect output path (specs/, docs/specs/, docs/, prd/), fallback to docs/specs/","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:06:58.70217-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.70588-08:00","closed_at":"2026-01-04T16:17:24.70588-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.11","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.702631-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.12","title":"Add end-of-interview validation","description":"Summary review, gap check, key decisions recap before finalizing spec","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:06:58.869739-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.706939-08:00","closed_at":"2026-01-04T16:17:24.706939-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.12","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.870191-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.7","title":"Create plugin structure","description":"Set up .claude-plugin/manifest.json, commands/interview.md, skills/interview/SKILL.md","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:06:58.039277-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.700861-08:00","closed_at":"2026-01-04T16:17:24.700861-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.7","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.041211-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.8","title":"Implement /interview command","description":"Entry point that accepts topic or file path, detects input type","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:06:58.199446-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.702368-08:00","closed_at":"2026-01-04T16:17:24.702368-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.8","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.199961-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.1.9","title":"Build 9-phase interview logic","description":"Adaptive depth: epic=40+ questions, task=10-15. Phases: Problem, Users, Scope, Technical, Constraints, Edge Cases, Testing, Success, Implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:06:58.366791-08:00","created_by":"agrande","updated_at":"2026-01-04T16:17:24.703611-08:00","closed_at":"2026-01-04T16:17:24.703611-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.1.9","depends_on_id":"sb-4y1.1","type":"parent-child","created_at":"2026-01-04T16:06:58.367264-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.2","title":"M2: TTS Integration","description":"Voice integration with /say (questions) and /summary-say (phase summaries). Auto-detect claude-mlx-tts, offer voice mode.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:05:44.133983-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.648935-08:00","closed_at":"2026-01-04T16:23:20.648935-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.2","depends_on_id":"sb-4y1","type":"parent-child","created_at":"2026-01-04T16:05:44.134473-08:00","created_by":"agrande"},{"issue_id":"sb-4y1.2","depends_on_id":"sb-4y1.1","type":"blocks","created_at":"2026-01-04T16:06:26.576343-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.2.1","title":"Auto-detect claude-mlx-tts","description":"Check if TTS plugin is installed, ask user once if they want voice mode","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:12.218569-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.494139-08:00","closed_at":"2026-01-04T16:23:20.494139-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.2.1","depends_on_id":"sb-4y1.2","type":"parent-child","created_at":"2026-01-04T16:07:12.220601-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.2.2","title":"Integrate /say for questions","description":"Voice interview questions using /say (short, exact wording)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:12.374925-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.495224-08:00","closed_at":"2026-01-04T16:23:20.495224-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.2.2","depends_on_id":"sb-4y1.2","type":"parent-child","created_at":"2026-01-04T16:07:12.375447-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.2.3","title":"Integrate /summary-say for summaries","description":"Voice phase summaries and final recap using /summary-say (long, condensed)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:12.52739-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.496224-08:00","closed_at":"2026-01-04T16:23:20.496224-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.2.3","depends_on_id":"sb-4y1.2","type":"parent-child","created_at":"2026-01-04T16:07:12.52786-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.2.4","title":"TTS pre-flight check","description":"Verify TTS works before deep interview. Auto-start server if needed, else inform user","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:12.68776-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.497282-08:00","closed_at":"2026-01-04T16:23:20.497282-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.2.4","depends_on_id":"sb-4y1.2","type":"parent-child","created_at":"2026-01-04T16:07:12.688293-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.3","title":"M3: Beads Integration","description":"Epic/subtask generation via bd CLI. Auto-detect .beads/, offer structure options (phases/requirements/milestones as subtasks).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:05:44.290979-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.650552-08:00","closed_at":"2026-01-04T16:23:20.650552-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.3","depends_on_id":"sb-4y1","type":"parent-child","created_at":"2026-01-04T16:05:44.291472-08:00","created_by":"agrande"},{"issue_id":"sb-4y1.3","depends_on_id":"sb-4y1.1","type":"blocks","created_at":"2026-01-04T16:06:26.606328-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.3.1","title":"Auto-detect beads","description":"Check for .beads/ directory to determine if beads integration is available","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:23.005447-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.498355-08:00","closed_at":"2026-01-04T16:23:20.498355-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.3.1","depends_on_id":"sb-4y1.3","type":"parent-child","created_at":"2026-01-04T16:07:23.007528-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.3.2","title":"Epic creation from spec","description":"At end of interview, ask if user wants to create epic + subtasks from the generated spec","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:23.169922-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.499436-08:00","closed_at":"2026-01-04T16:23:20.499436-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.3.2","depends_on_id":"sb-4y1.3","type":"parent-child","created_at":"2026-01-04T16:07:23.170446-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.3.3","title":"Subtask structure options","description":"Present structure options: phases as subtasks, requirements as subtasks, or milestones as subtasks","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:23.329924-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.500471-08:00","closed_at":"2026-01-04T16:23:20.500471-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.3.3","depends_on_id":"sb-4y1.3","type":"parent-child","created_at":"2026-01-04T16:07:23.33037-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.3.4","title":"bd CLI integration","description":"Use bd commands to create issues. Never modify .beads/ directly. Handle failures with fix+retry or skip","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:23.486629-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.501328-08:00","closed_at":"2026-01-04T16:23:20.501328-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.3.4","depends_on_id":"sb-4y1.3","type":"parent-child","created_at":"2026-01-04T16:07:23.487101-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4","title":"M4: Templates \u0026 Ship","description":"All interview templates (Feature, Bug, Refactor, Integration, Adaptive), polish, README, and publish to marketplace.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:05:44.448869-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:31.608012-08:00","closed_at":"2026-01-04T16:23:31.608012-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4","depends_on_id":"sb-4y1","type":"parent-child","created_at":"2026-01-04T16:05:44.449328-08:00","created_by":"agrande"},{"issue_id":"sb-4y1.4","depends_on_id":"sb-4y1.1","type":"blocks","created_at":"2026-01-04T16:06:26.632347-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.1","title":"Feature interview template","description":"Template for new feature interviews - full depth, all phases","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.113148-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:12.130275-08:00","closed_at":"2026-01-04T16:23:12.130275-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.1","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.115028-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.2","title":"Bug interview template","description":"Template for bug investigation - focused on reproduction, root cause, fix verification","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.27556-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:19.9959-08:00","closed_at":"2026-01-04T16:23:19.9959-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.2","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.276021-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.3","title":"Refactor interview template","description":"Template for refactoring work - scope, constraints, testing strategy","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.439069-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.128243-08:00","closed_at":"2026-01-04T16:23:20.128243-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.3","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.43957-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.4","title":"Integration interview template","description":"Template for integrating external systems/APIs - endpoints, auth, error handling","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.602637-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.264897-08:00","closed_at":"2026-01-04T16:23:20.264897-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.4","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.603104-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.5","title":"Adaptive interview template","description":"Default template that adapts depth based on detected scope","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.773022-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.406371-08:00","closed_at":"2026-01-04T16:23:20.406371-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.5","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.773671-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.6","title":"Write README","description":"Minimal README: install instructions, basic usage, one example","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:38.949212-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:20.552978-08:00","closed_at":"2026-01-04T16:23:20.552978-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.6","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:38.949701-08:00","created_by":"agrande"}]}
{"id":"sb-4y1.4.7","title":"Publish to marketplace","description":"Final polish and publish to Claude Plugin Marketplace","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:07:39.122542-08:00","created_by":"agrande","updated_at":"2026-01-04T16:23:25.672558-08:00","closed_at":"2026-01-04T16:23:25.672558-08:00","close_reason":"Closed","dependencies":[{"issue_id":"sb-4y1.4.7","depends_on_id":"sb-4y1.4","type":"parent-child","created_at":"2026-01-04T16:07:39.122991-08:00","created_by":"agrande"}]}
{"id":"sb-6ga","title":"Add once:true PreToolUse hook for TTS auto-detection","description":"**Problem:**\nCurrently TTS detection happens manually during Phase 0 initialization. The skill explicitly checks `/tts-status`, offers to start the server, and asks user preference. This adds complexity to the interview flow.\n\n**Solution:**\nAdd a `once: true` PreToolUse hook in the command frontmatter that:\n1. Runs before the first `AskUserQuestion` call\n2. Invokes `claude-mlx-tts:tts-status` to check availability\n3. Sets environment variable (e.g., `TTS_AVAILABLE=1`) for skill to reference\n4. Optionally auto-starts server if not running\n\n**Implementation in commands/interview.md:**\n```yaml\n---\ndescription: Conduct an adaptive interview...\nhooks:\n  PreToolUse:\n    - matcher: AskUserQuestion\n      once: true\n      run: |\n        # Check TTS availability before first question\n        echo 'Checking TTS availability...'\n```\n\n**Benefits:**\n- Removes boilerplate from Phase 0\n- Consistent TTS detection across interview and blitz\n- Cleaner separation of concerns\n\n**Files to modify:**\n- commands/interview.md\n- commands/blitz.md\n- skills/interview/references/tts-integration.md (update docs)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T09:56:36.880249-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:36.880249-08:00","dependencies":[{"issue_id":"sb-6ga","depends_on_id":"sb-dxq","type":"blocks","created_at":"2026-01-08T09:57:20.51617-08:00","created_by":"agrande"}]}
{"id":"sb-8ev","title":"Add blitz mode to interview skill","description":"Update skills/interview/SKILL.md with blitz mode logic: detect --blitz flag, load bead context, run adaptive 3-10 question interview, update bead and/or append to spec.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:39:49.041257-08:00","created_by":"agrande","updated_at":"2026-01-04T17:06:55.906015-08:00","closed_at":"2026-01-04T17:06:55.906015-08:00","close_reason":"Implemented blitz mode with TTS auto-detection","dependencies":[{"issue_id":"sb-8ev","depends_on_id":"sb-a42","type":"blocks","created_at":"2026-01-04T16:40:03.337917-08:00","created_by":"agrande"},{"issue_id":"sb-8ev","depends_on_id":"sb-a90","type":"blocks","created_at":"2026-01-04T16:40:03.368323-08:00","created_by":"agrande"},{"issue_id":"sb-8ev","depends_on_id":"sb-y1n","type":"blocks","created_at":"2026-01-04T16:40:03.398815-08:00","created_by":"agrande"}]}
{"id":"sb-8o5","title":"TTS: Use /say skill, not direct HTTP to server","description":"Claude sometimes tries to hit the TTS server directly via curl instead of using the /say skill.\n\nExample of WRONG behavior:\n```\ncurl -s -X POST \"http://localhost:21099/speak\" -H \"Content-Type: application/json\" -d '{\"text\": \"...\"}'\n```\n\nThis fails because:\n1. Wrong port (guessed)\n2. Wrong endpoint (guessed)\n3. Should use the skill, not direct HTTP\n\nCorrect behavior:\n```\nInvoke skill: claude-mlx-tts:say\nArgs: \"text to speak\"\n```\n\nUpdate SKILL.md and command files to explicitly state:\n- DO NOT use curl/HTTP to speak text\n- DO invoke the /say or /summary-say skills\n- The skill handles all server communication internally","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T17:39:09.822355-08:00","created_by":"agrande","updated_at":"2026-01-04T18:37:00.491756-08:00","closed_at":"2026-01-04T18:37:00.491756-08:00","close_reason":"All SKILL.md and command files now explicitly prohibit curl/HTTP for TTS and require using /say and /summary-say skills instead"}
{"id":"sb-a42","title":"Add blitz command file","description":"Create commands/blitz.md as alias to /interview --blitz. Parse bead ID argument, validate format (bd-xxxx or bd-xxxx.n).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:39:48.712851-08:00","created_by":"agrande","updated_at":"2026-01-04T17:06:55.902061-08:00","closed_at":"2026-01-04T17:06:55.902061-08:00","close_reason":"Implemented blitz mode with TTS auto-detection"}
{"id":"sb-a90","title":"Add --blitz flag to interview command","description":"Update commands/interview.md to accept --blitz flag. When present, route to blitz mode in skill.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:39:48.877899-08:00","created_by":"agrande","updated_at":"2026-01-04T17:06:55.903939-08:00","closed_at":"2026-01-04T17:06:55.903939-08:00","close_reason":"Implemented blitz mode with TTS auto-detection"}
{"id":"sb-b6k","title":"Blitz: Run TTS detection and bead show in parallel","description":"During blitz initialization, TTS detection (invoke tts-status) and bead context loading (bd show) are independent operations that currently run sequentially. They could run in parallel to reduce startup latency.\n\nCurrent flow:\n1. Validate bead ID\n2. Load bead context (bd show) \n3. Auto-detect TTS (invoke tts-status)\n\nProposed flow:\n1. Validate bead ID\n2. In parallel:\n   - Load bead context (bd show)\n   - Auto-detect TTS (invoke tts-status)\n3. Proceed with interview\n\n## Clarifications from Blitz Interview\n\n**Race handling**: No shared state between operations. They are fully independent. The TTS status result will control subsequent behavior (whether to use voice or not).\n\n**Failure mode**: If TTS detection fails/times out while bead loading succeeds:\n- Mention the TTS failure to the user\n- Proceed with text-only interview\n\n**Documentation**: Update SKILL.md blitz initialization section AND add inline code comments explaining the parallel execution pattern.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-04T17:37:46.267254-08:00","created_by":"agrande","updated_at":"2026-01-04T19:30:47.377151-08:00","closed_at":"2026-01-04T19:30:47.377151-08:00","close_reason":"Updated SKILL.md and commands/blitz.md to document parallel execution of TTS detection and bead context loading"}
{"id":"sb-bw2","title":"Add context:fork to blitz command for isolated execution","description":"**Problem:**\nThe `/blitz` command runs a rapid 3-10 question clarification interview for an existing bead. Currently it shares context with the parent conversation, which can be noisy.\n\n**Solution:**\nAdd `context: fork` to the blitz command frontmatter. This runs the blitz interview in a forked sub-agent context that:\n1. Preserves access to parent conversation context (can see prior discussion)\n2. Isolates blitz interview state from polluting parent\n3. Returns results cleanly when complete\n\n**Implementation in commands/blitz.md:**\n```yaml\n---\ndescription: Rapid clarification interview for an existing bead (3-10 questions)\ncontext: fork\n---\n```\n\n**Benefits:**\n- Cleaner separation between blitz and main conversation\n- Blitz interview doesn't add intermediate state to parent\n- More predictable behavior for contained interactions\n\n**Considerations:**\n- Test that bead context is still accessible in forked mode\n- Verify TTS still works across fork boundary\n- Ensure final results propagate back correctly\n\n**Files to modify:**\n- commands/blitz.md","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-08T09:56:37.042727-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:37.042727-08:00","dependencies":[{"issue_id":"sb-bw2","depends_on_id":"sb-dxq","type":"blocks","created_at":"2026-01-08T09:57:20.548591-08:00","created_by":"agrande"}]}
{"id":"sb-d5i","title":"Convert allowed-tools to YAML-style lists","description":"**Problem:**\nIf/when allowed-tools declarations are added to skill frontmatter, the old format uses comma-separated strings which are harder to read and maintain.\n\n**Solution:**\nUse the new YAML-style list format for any allowed-tools declarations:\n\n**Old format:**\n```yaml\nallowed-tools: Skill, AskUserQuestion, Read, Bash(bd *)\n```\n\n**New format:**\n```yaml\nallowed-tools:\n  - Skill\n  - AskUserQuestion\n  - Read\n  - Bash(bd *)\n```\n\n**Benefits:**\n- More readable\n- Easier to add/remove tools\n- Better diff visibility in version control\n- Consistent with modern YAML practices\n\n**Note:** This is a low-priority cleanup task. Only apply when adding or modifying allowed-tools declarations.\n\n**Files to potentially modify:**\n- commands/interview.md\n- commands/blitz.md\n- skills/interview/SKILL.md","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-08T09:56:37.546727-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:37.546727-08:00","dependencies":[{"issue_id":"sb-d5i","depends_on_id":"sb-dxq","type":"blocks","created_at":"2026-01-08T09:57:20.637191-08:00","created_by":"agrande"}]}
{"id":"sb-db1","title":"Investigate running TTS say/summary-say in background by default","description":"# Investigation Complete: Background TTS Execution\n\n## Executive Summary\n\n**Recommendation**: Modify skill prompts to instruct Claude to use `run_in_background: true` when invoking the Bash tool. This is a plugin-side change requiring no Claude Code modifications.\n\n## Findings\n\n### Mechanism 1: Bash `run_in_background` Parameter ‚úÖ WORKS\n\nThe Bash tool has a `run_in_background` parameter:\n- Runs commands asynchronously, returns task ID immediately\n- Output buffered for retrieval via `TaskOutput` tool\n- **Verified**: TTS ran successfully in background while Claude continued working\n\n### Mechanism 2: Skill Metadata Declaration ‚ùå NOT SUPPORTED\n\nSkills cannot declare background execution in YAML frontmatter. Only `description` is available; no `background`, `async`, or similar fields exist.\n\n### Mechanism 3: Skill Prompt Instruction ‚úÖ RECOMMENDED\n\nSkill prompts can include instructions for Claude to follow. Modified skill example:\n\n```markdown\n---\ndescription: Speak text directly using TTS (smoke test)\n---\n\nRun this command in the **background** so you can continue working while audio plays:\n\n\\`\\`\\`bash\n${CLAUDE_PLUGIN_ROOT}/scripts/say.sh $ARGUMENTS\n\\`\\`\\`\n\n**Important**: Use `run_in_background: true` when calling the Bash tool.\n```\n\n### Mechanism 4: Self-Backgrounding Script ‚ö†Ô∏è POSSIBLE BUT NOT RECOMMENDED\n\nScript could use `(command \u0026)` or `nohup`, but:\n- Complicates error handling\n- Loses output feedback to Claude\n- More maintenance burden\n\n## Tradeoff Analysis\n\n| Approach | Reliability | Complexity | Error Handling | Plugin-side |\n|----------|-------------|------------|----------------|-------------|\n| Skill prompt instruction | Medium | Low | Good | ‚úÖ |\n| Self-backgrounding script | High | Medium | Poor | ‚úÖ |\n\n## Recommendation\n\n**Primary approach**: Modify `/say` and `/summary-say` skill prompts to instruct Claude to use `run_in_background: true`.\n\n**Why this is best**:\n1. Uses Claude Code's built-in mechanism\n2. Preserves error handling (output retrievable via TaskOutput)\n3. No script changes required\n4. Purely plugin-side solution\n5. Low complexity\n\n**Generalizing to other skills**: Any skill can adopt this pattern by adding background execution instructions to its prompt markdown. This is a documentation/convention pattern, not a technical limitation.\n\n## Limitations\n\n1. Relies on Claude following prompt instructions (not enforced)\n2. No way to declaratively specify background in skill metadata\n3. Output requires explicit TaskOutput retrieval if needed\n\n## Next Steps\n\nCreate follow-up task to implement the skill prompt changes for `/say` and `/summary-say`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T18:28:59.788949-08:00","created_by":"agrande","updated_at":"2026-01-04T18:59:16.830935-08:00","closed_at":"2026-01-04T18:59:16.830935-08:00","close_reason":"Investigation complete. Recommended approach: modify skill prompts to instruct Claude to use run_in_background:true."}
{"id":"sb-dqk","title":"Add Stop hook for interview cleanup and summary","description":"**Problem:**\nWhen an interview ends (either by completion or interruption), there's no automatic cleanup or summary mechanism. Users may lose context about what was accomplished.\n\n**Solution:**\nAdd a `Stop` hook to the interview command that:\n1. Detects interview completion or interruption\n2. Provides a brief summary of progress made\n3. Optionally saves partial state for resume\n\n**Implementation in commands/interview.md:**\n```yaml\n---\nhooks:\n  Stop:\n    - run: |\n        echo 'Interview session ended.'\n        # Could log interview stats, save state, etc.\n---\n```\n\n**Use cases:**\n- User cancels mid-interview: hook summarizes what was captured\n- Interview completes: hook confirms spec was generated\n- Error occurs: hook provides graceful messaging\n\n**Benefits:**\n- Better user experience on interruption\n- Potential for resume functionality\n- Consistent session end behavior\n\n**Files to modify:**\n- commands/interview.md\n- commands/blitz.md (similar hook)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-08T09:56:37.378524-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:37.378524-08:00","dependencies":[{"issue_id":"sb-dqk","depends_on_id":"sb-dxq","type":"blocks","created_at":"2026-01-08T09:57:20.60788-08:00","created_by":"agrande"}]}
{"id":"sb-dxq","title":"Upgrade skills to leverage Claude Code 2.1.0 features","description":"Claude Code 2.1.0 introduces several features that can improve the interview/blitz skills:\n\n**Key Features to Leverage:**\n- Hooks support in skill/command frontmatter (PreToolUse, PostToolUse, Stop)\n- `once: true` config for hooks (run initialization only once)\n- `context: fork` for isolated sub-agent execution\n- YAML-style lists in allowed-tools field\n- `user-invocable: false` to hide internal skills from menu\n\n**Goals:**\n1. Simplify TTS detection with automatic hooks\n2. Improve blitz mode isolation\n3. Apply best practices to skill structure\n4. Cleaner frontmatter organization","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-08T09:56:01.797583-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:09.23509-08:00"}
{"id":"sb-h6x","title":"Implement caller-side TTS pacing","description":"Add adaptive TTS pacing to interview skill to improve UX for fast typists.\n\n## Core Approach: Sequential Questions with Voice\n\n**One question at a time, voice before each:**\n```\nsay.sh \"About timing...\" \u0026\nAskUserQuestion(single question)\n# measure response time\n# apply pacing logic\n# repeat\n```\n\nNo batching. No delays. Voice trails visual by ~100-200ms (natural, like a narrator).\n\n## Timing Logic\n- **Quick response threshold**: Under 5 seconds from AskUserQuestion invocation\n- **Reset behavior**: Pacing state resets at phase transitions\n- **Rapid-fire signal**: User answers before voice would finish (~2s)\n\n## Anchor Questions (Always Voiced)\n- Phase introductions (\"Now entering Requirements phase...\")\n- Recap summaries (\"Here's what we've captured...\")\n\n## Skipped When Rapid-Fire\n- Regular questions after user demonstrates fast response pattern\n- Re-enable voice at next phase transition or after slow response\n\n## Visual Feedback\n- Show üîá when voice is skipped\n\n## Voice Content\n- Short intros only: \"About timing...\" not full question text\n- ~1-2 seconds of audio per intro\n- User reads details visually\n\n## Architecture\n- Interview skill only\n- No AskUserQuestion batching when voice enabled\n- No synchronization complexity","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:48:37.906392-08:00","created_by":"agrande","updated_at":"2026-01-04T20:18:04.872081-08:00","closed_at":"2026-01-04T20:18:04.872081-08:00","close_reason":"Implemented sequential TTS pacing in tts-integration.md and SKILL.md"}
{"id":"sb-l2h","title":"Implement bead context loading","description":"Add logic to load rich context: bead fields via bd show, linked files from description, related beads (parent epic, blockers, dependencies).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:39:49.354374-08:00","created_by":"agrande","updated_at":"2026-01-04T17:00:57.747304-08:00","closed_at":"2026-01-04T17:00:57.747304-08:00","close_reason":"Created references/bead-context.md with comprehensive context loading logic: bead fields via bd show, linked files from description, related beads (parent, blockers, deps), completeness detection, and error handling.","dependencies":[{"issue_id":"sb-l2h","depends_on_id":"sb-8ev","type":"blocks","created_at":"2026-01-04T16:40:03.428377-08:00","created_by":"agrande"}]}
{"id":"sb-lg7","title":"Interview progress only voiced, not printed when TTS enabled","description":"When TTS is enabled, interview progress steps are only spoken via /say but not printed to the screen.\n\n## Current behavior\n- TTS disabled: progress printed to screen\n- TTS enabled: progress only spoken, nothing printed\n\n## Expected behavior\n- TTS disabled: progress printed to screen\n- TTS enabled: progress printed AND spoken\n\n## Scope\nThis applies to ALL interview output:\n- Questions\n- Progress indicators\n- Summaries\n\nVisual output is MANDATORY regardless of TTS state. TTS is supplementary, not a replacement for visual output.\n\n## Files to Update\n1. Documentation: SKILL.md and tts-integration.md\n2. Implementation: Search codebase for interview/TTS integration code\n\n## Acceptance Criteria\n- Every voiced message MUST also appear as text in the terminal\n- No configuration option needed - visual output is always required","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-04T17:41:39.970474-08:00","created_by":"agrande","updated_at":"2026-01-04T18:33:14.382503-08:00","closed_at":"2026-01-04T18:33:14.382503-08:00","close_reason":"Fixed by updating documentation to clarify that visual output is MANDATORY regardless of TTS state. Updated tts-integration.md, SKILL.md, interview.md, blitz.md, and blitz-questions.md to emphasize TTS is supplementary (adds voice ON TOP OF visual output), not a replacement."}
{"id":"sb-n1p","title":"Add user-invocable:false to internal SKILL.md","description":"**Problem:**\nThe file `skills/interview/SKILL.md` is the internal implementation loaded by the `/interview` command. With 2.1.0, skills in `/skills/` directories are now visible in the slash command menu by default. Users might accidentally invoke SKILL.md directly instead of using the proper `/interview` entry point.\n\n**Solution:**\nAdd `user-invocable: false` to the SKILL.md frontmatter to hide it from the slash command menu.\n\n**Implementation in skills/interview/SKILL.md:**\n```yaml\n---\nuser-invocable: false\n---\n```\n\n**Benefits:**\n- Prevents accidental direct invocation\n- Cleaner slash command menu (only shows /interview and /blitz)\n- Follows plugin best practices\n\n**Files to modify:**\n- skills/interview/SKILL.md","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-08T09:56:37.215222-08:00","created_by":"agrande","updated_at":"2026-01-08T09:56:37.215222-08:00","dependencies":[{"issue_id":"sb-n1p","depends_on_id":"sb-dxq","type":"blocks","created_at":"2026-01-08T09:57:20.578816-08:00","created_by":"agrande"}]}
{"id":"sb-y1n","title":"Create blitz-questions.md reference","description":"Create skills/interview/references/blitz-questions.md with work-type driven question sets: Bug (repro, impact), Feature (scope, acceptance), Task (impl, blockers), Refactor (target, migration).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:39:49.194835-08:00","created_by":"agrande","updated_at":"2026-01-04T17:06:55.904945-08:00","closed_at":"2026-01-04T17:06:55.904945-08:00","close_reason":"Implemented blitz mode with TTS auto-detection"}
